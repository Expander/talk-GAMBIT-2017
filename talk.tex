
\documentclass[hyperref={pdfpagelabels=false},ngerman]{beamer}

% stop font warning
\let\Tiny=\tiny
\providecommand\thispdfpagelabel[1]{}

\usepackage[english]{babel}
\usepackage{lmodern}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{graphicx,import}
\usepackage{feynmp}
\DeclareGraphicsRule{*}{mps}{*}{} 
\DeclareGraphicsExtensions{.pdf}
\usepackage{amsmath,amssymb,amstext,amsfonts} % mathrsfs
\usepackage{array,booktabs,tabularx}
\usepackage{tikz,tikz-uml,pgf-pie}
\usetikzlibrary{shapes,calc,arrows,positioning,shapes}
\tikzstyle{block} = [rectangle, draw, thick, text width=10em, text centered, minimum height=2em]
\tikzstyle{arrow} = [draw, -latex, thick]
\tikzstyle{arrow2} = [draw, latex-latex, thick]
\tikzstyle{quark}  = [rectangle, draw, fill=yellow, minimum width=2em, text centered, minimum height=2em]
\tikzstyle{lepton} = [rectangle, draw, fill=red!50, minimum width=2em, text centered, minimum height=2em]
\tikzstyle{gauge}  = [circle   , draw, fill=green , minimum size=2em, inner sep=0pt, text centered]
\tikzstyle{scalar} = [diamond  , draw, fill=blue!40, minimum width=2.3em, text centered, minimum height=2.3em, inner sep=0pt]
\tikzstyle{goldstone} = [diamond, draw, dashed, fill=blue!30, minimum width=2.3em, text centered, minimum height=2.3em, inner sep=0pt]
\tikzstyle{squark}   = [diamond, draw, fill=yellow, minimum width=2.3em, text centered, minimum height=2.3em, inner sep=0pt]
\tikzstyle{slepton}  = [diamond, draw, fill=red!50, minimum width=2.3em, text centered, minimum height=2.3em, inner sep=0pt]
\tikzstyle{gaugino}  = [rectangle, draw, fill=green , minimum size=2em, inner sep=0pt, text centered]
\tikzstyle{higgsino} = [rectangle, draw, fill=blue!40  , minimum width=2em, text centered, minimum height=2em]
\tikzstyle{inert}    = [diamond  , draw, fill=teal!80, minimum width=2.3em, text centered, minimum height=2.3em, inner sep=0pt]
\tikzstyle{inertino} = [rectangle, draw, fill=teal!80, minimum width=2em, text centered, minimum height=2em]
\tikzstyle{phantom}  = [rectangle, minimum width=2em, text centered, minimum height=2em]
\usepackage{slashed}
\usepackage{fixltx2e} % textsubscript
\usepackage{multirow}
\usepackage{tcolorbox}
\usepackage{pifont}
\usepackage{xspace}
\usepackage{hyperref}
\hypersetup{colorlinks,linkcolor=,urlcolor=blue}
\usepackage{listings}
\lstset{breaklines=true,
  breakatwhitespace=true,
  numbers=left,
  numberstyle=\tiny,
  stepnumber=1,
  basicstyle=\ttfamily\scriptsize,
  commentstyle=\ttfamily\color{gray},
  postbreak={\mbox{{$\hookrightarrow$}}\space\space},
  breakindent=10pt,
  breakautoindent=false,
  showspaces=false,
  showstringspaces=false,
  frame=single}

\definecolor{darkgreen}{RGB}{0,176,0}
\definecolor{darkred}{RGB}{200,0,0}
\definecolor{darkred}{RGB}{200,0,0}
\definecolor{darkyellow}{RGB}{255,165,0}

\newcommand{\cmark}{\ding{51}}%
\newcommand{\xmark}{\ding{55}}%
\newcommand{\fmfvcenter}[1]{\;\vcenter{\hbox{\fmfreuse{#1}}}\;}
\newcommand{\eh}[1]{\,\mathsf{#1}}
\newcommand{\ok}{\textcolor{darkgreen}{\cmark}}
\newcommand{\notok}{\textcolor{red}{\xmark}}
\newcommand{\maybe}{\textcolor{gray}{\cmark}}
\newcommand{\meh}{\textcolor{gray}{\textbf{\huge\lower.1em\hbox{-}}}}
\newcommand{\Lagr}{\mathcal{L}}
\newcommand{\MS}{\ensuremath{M_S}}
\newcommand{\mathi}{\mathsf{i}}
\newcommand{\mycite}[1]{\ensuremath{\text{\textcolor{darkgray}{\tiny [#1]}}}}
\newcommand{\bigcite}[1]{\textcolor{darkgray}{[#1]}}
\newcommand{\dimrep}[1]{\mathbf{#1}}
\newcommand{\dimrepadj}[1]{\mathbf{\overline{#1}}}
\newcommand{\ESSM}{E\textsubscript{6}SSM}
\newcommand{\CESSM}{CE\textsubscript{6}SSM}
\DeclareMathOperator{\tildeRe}{\widetilde Re}
\DeclareMathOperator{\sign}{sign}
\DeclareMathOperator{\re}{Re}
\DeclareMathOperator{\im}{Im}
\renewcommand{\emph}{\textbf}
\newcommand{\dd}{\mathsf{d}}
\newcommand{\myurl}[1]{\href{#1}{#1}}
\newcommand{\Superpot}{\mathcal{W}}
\newcommand{\SuperField}[1]{#1}
\newcommand{\ConjSuperField}[1]{\bar{#1}}
\newcommand{\UY}{\ensuremath{U(1)_{Y}}}
\newcommand{\UN}{\ensuremath{U(1)_{N}}}
\newcommand{\Uem}{\ensuremath{U(1)_\text{em}}}
\newcommand{\SUL}{\ensuremath{SU(2)_\text{L}}}
\newcommand{\SUc}{\ensuremath{SU(3)_\text{c}}}
\newcommand{\SOten}{\ensuremath{{SO(10)}}}
\newcommand{\comma}{,}
\newcommand{\DRbar}{\ensuremath{\overline{\text{DR}}}}
\newcommand{\MSbar}{\ensuremath{\overline{\text{MS}}}}
\newcommand{\SM}{\ensuremath{\text{SM}}}
\newcommand{\MSSM}{\ensuremath{\text{MSSM}}}
\newcommand{\MRSSM}{\ensuremath{\text{MRSSM}}}
\newcommand{\pole}{\ensuremath{\text{pole}}}
\newcommand{\tree}{\ensuremath{\text{tree}}}
\newcommand{\fsstar}{\textbf{*}}
\newcommand{\Zv}{\ensuremath{\backslash\mkern-11.0mu{Z_3}}}
\newcommand{\downrightknickarrow}{\mathrel{\scalebox{1.3}{\rotatebox[origin=c]{180}{$\Lsh$}}}}
\newcommand{\threelinebrace}{$\left. \begin{array}{c} \\ \\ \\ \end{array} \right\rbrace$}
\newcommand{\fivelinebrace}{$\left. \begin{array}{c} \\ \\ \\ \\ \\ \end{array} \right\rbrace$}
\newcommand{\twolinebrace}{$\left. \begin{array}{c} \\ \\ \end{array} \right\rbrace$}
\newcommand{\elevenlinebrace}{$\left. \begin{array}{c} \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \end{array} \right\rbrace$}
\newcommand{\at}{\alpha_t}
\newcommand{\ab}{\alpha_b}
\newcommand{\atau}{\alpha_\tau}
\newcommand{\as}{\alpha_s}
\newcommand{\SARAH}{\texttt{SARAH}}
\newcommand{\Mathematica}{\texttt{Mathematica}}
\newcommand{\Himalaya}{\texttt{Himalaya}}
\newcommand{\GMTCalc}{\texttt{GM2Calc}}
\newcommand{\GAMBIT}{\texttt{GAMBIT}}

% set look of slides
\usetheme{Madrid}
\useoutertheme{default}
\useinnertheme{circles}
\usecolortheme{default}
\beamertemplatenavigationsymbolsempty % keine Navigationselemente
\setbeamersize{text margin left = 1cm, text margin right = 1cm}

% define footer
\makeatletter
\setbeamertemplate{footline}
{
  \hfill\hbox{\insertframenumber{} / \inserttotalframenumber\hspace*{4pt}}%
  \vskip3pt%
}
\makeatother
\usecolortheme{tud}
\setbeamertemplate{blocks}[rounded][shadow=false]

\title{FlexibleSUSY}

\author[Alexander Voigt]{P.\ Athron, M.\ Bach, D.\ Harries, T.\
  Kwasnitza, J.-h.\ Park,\\ T.\ Steudtner, D.\ StÃ¶ckinger, J.\ Ziebell,
  \underline{A.\ Voigt}}

\date{Dartmouth-TRIUMF HEP Tools Bootcamp\\ 27.10.2017}

\institute[Aachen]{\url{https://flexiblesusy.hepforge.org/}}
\subject{FlexibleSUSY,MSSM,Higgs,FlexibleEFTHiggs}
\keywords{FlexibleSUSY,MSSM,Higgs,FlexibleEFTHiggs}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[plain]
  \tikz [remember picture,overlay]
  \node at
    ([yshift=1.3cm,xshift=4cm]current page.south)
    {\includegraphics[height=2cm]{images/RWTH_Logo}};
  \tikz [remember picture,overlay]
  \node at
    ([yshift=2cm,xshift=-4cm]current page.south)
    {\includegraphics[height=2.5cm]{images/FS.png}};
  \titlepage  
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Contents}
  \tableofcontents
\end{frame}

\section{What is FlexibleSUSY?}

\begin{frame}{Contents}
  \tableofcontents[currentsection]  
\end{frame}

\begin{frame}{What is FlexibleSUSY?}
  \begin{center}
    \includegraphics[width=\textwidth]{images/FS.png}
  \end{center}
  \tikz[overlay,remember picture] 
  \node[at=(current page.north east),anchor=north east,inner sep=0pt, xshift=-1.5cm, yshift=-2cm] (FS) {
    \textbf{FlexibleSUSY}};
  \tikz[overlay,remember picture] 
  \draw[-latex,thick] ([yshift=-0.2cm] FS.south) to[out=270,in=0] ++(-2cm,-2cm);
\end{frame}

\begin{frame}{What is FlexibleSUSY?}
  \begin{center}
    \begin{tikzpicture}
    \node[block] (EXPR) {\textbf{analytic expressions}\\ (\Mathematica)\\ $\beta_g$, $M_h$, $\Sigma_h$, \ldots};
    % \node[block, below = 1cm of EXPR, text width=15em] (FS) {\textbf{spectrum generator}\\ (C++)\\ solves BVP, calculates observables};
    \node[block, below = 1cm of EXPR, text width=15em] (FS) {\textbf{spectrum generator}\\ (C++)\\ \footnotesize{\texttt{double calc\_Mhh() \{ return ...; \}}}};
    \node[block, below = 1cm of FS] (OUT) {$M_h^\pole$, $(g-2)_\mu$, EDMs, $h\rightarrow\gamma\gamma$, $h\rightarrow gg$};
    \path[arrow] (EXPR) -- node[right]{generates} (FS);
    \path[arrow] (FS) -- node[right]{calculates obs.} node[left]{solves BVP} (OUT);
    \draw[red,very thick] ($(EXPR.north west)+(-1.5,0.5)$) node(FSname){} rectangle ($(OUT.south east)+(1.5,-0.5)$);
    \node[above right = 0cm and 0cm of FSname.north west] {\textbf{\textcolor{red}{FlexibleSUSY}}};
    \node[block, right = 2cm of EXPR, text width=5em] (SARAH) {\textbf{\SARAH}};
    \path[arrow] (SARAH) -- node[above]{calculates} (EXPR);
    \end{tikzpicture}
  \end{center}
\end{frame}

\begin{frame}{Example: BVP in the CMSSM}
  \begin{center}
  \begin{tikzpicture}
    \path[arrow] (0,0) -- (0,5) node[left]{$Q$};
    \draw[thick,darkgreen] (0,4) node[left]{$M_X$} -- node[above = 0.5cm,black]{GUT} (3,4) node[right,black]{fix $m_{\tilde{f}}^2, A_f, M_i, \sign\mu$};
    \draw[thick,dashed,darkgreen] (0,1.5) node[left]{$M_S$} -- (3,1.5) node[right,black]{fix $|\mu|, B\mu$};
    \draw[thick,darkgreen] (0,1) node[left]{$M_Z$} -- node[above = 1.2cm,black]{MSSM} node[below = 0.5cm,black]{SM(5)} (3,1) node[right,black]{fix $g_i, y_f, v_i$};
  \end{tikzpicture}
  \end{center}
\end{frame}

\begin{frame}{Example: BVP in the MSSM with light Higgs sector}
  \begin{center}
  \begin{tikzpicture}
    \path[arrow] (0,0) -- (0,5) node[left]{$Q$};
    \draw[thick,darkgreen] (0,4) node[left]{$M_S$} -- node[above = 0.5cm,black]{MSSM} (3,4) node[right,black]{fix $\lambda_i$, $m_{12}^2$};
    \draw[thick,dashed,darkgreen] (0,1.5) node[left]{$M_t$} -- (3,1.5) node[right,black]{fix $m_1^2$, $m_2^2$};
    \draw[thick,darkgreen] (0,1) node[left]{$M_Z$} -- node[above = 1.2cm,black]{2HDM-II} node[below = 0.5cm,black]{SM(5)} (3,1) node[right,black]{fix $g_i, y_f, v, \tan\beta$};
  \end{tikzpicture}
  \end{center}
\end{frame}

\section{Features}

\begin{frame}{Contents}
  \tableofcontents[currentsection]  
\end{frame}

\newenvironment{obsblock}[1]{%
  \setbeamercolor{block body}{bg=darkgreen!10}
  \setbeamercolor{block title}{bg=darkgreen}
  \begin{block}{#1}}{\end{block}}

\newenvironment{precblock}[1]{%
  \setbeamercolor{block body}{bg=darkred!10}
  \setbeamercolor{block title}{bg=darkred}
  \begin{block}{#1}}{\end{block}}

\newenvironment{flexblock}[1]{%
  \setbeamercolor{block body}{bg=blue!10}
  \setbeamercolor{block title}{bg=blue}
  \begin{block}{#1}}{\end{block}}

\newenvironment{speedblock}[1]{%
  \setbeamercolor{block body}{bg=black!10}
  \setbeamercolor{block title}{bg=black}
  \begin{block}{#1}}{\end{block}}

\begin{frame}{Features for all models (SUSY and non-SUSY)}
  \begin{columns}[T]
    \begin{column}{0.49\textwidth}
      \begin{obsblock}{Observables}
        $M_h$, $M_W$, BSM masses, $(g-2)_\mu$, EDMs,\\
        $h\rightarrow\gamma\gamma$, $h\rightarrow gg$
      \end{obsblock}
      \begin{flexblock}{Flexibility}
        multipe BVP solvers, user-defined BCs,\\ modular C++ code, \\
        SLHA input/output, \Mathematica\ input/output, SQLite output
      \end{flexblock}
    \end{column}
    \begin{column}{0.49\textwidth}
      \begin{precblock}{High precision}
        2L RGEs + 1L self energies (via \SARAH) + 1L thresholds,\\
        NLL resummation for $M_h$ (\texttt{FlexibleEFTHiggs})
      \end{precblock}
      \begin{speedblock}{High speed}
        multi-threading,\\ smart linear algebra,\\ lazy evaluation
      \end{speedblock}
    \end{column}
  \end{columns}
\end{frame}

\newenvironment{modelblock}[1]{%
  \setbeamercolor{block body}{bg=darkyellow!15}
  \setbeamercolor{block title}{fg=black,bg=darkyellow}
  \begin{block}{#1}}{\end{block}}

\begin{frame}{Additional model-specific precision corrections}
  \begin{columns}[T]
    \begin{column}{0.49\textwidth}
      \begin{modelblock}{MSSM}
        3L RGEs, 3L $M_h$, 2L $M_{H,A,H^\pm}$, 2L $(g-2)_\mu$, 2L
        thresholds
      \end{modelblock}
      \begin{modelblock}{NMSSM}
        2L $M_h$, 2L $M_{H,A,H^\pm}$, 2L thresholds
      \end{modelblock}
      \begin{modelblock}{Split-MSSM}
        3L $M_h$, 2L thresholds for $y_t$, 2L thresholds for $\lambda$, $\tilde{g}_{ip}$
        the MSSM
      \end{modelblock}
    \end{column}
    \begin{column}{0.49\textwidth}
      \begin{modelblock}{SM}
        3L RGEs, 3L $M_h$, 3L thresholds for $\as$, $y_{t,b}$, 2L
        thresholds for $\lambda$ to the MSSM (\texttt{HSSUSY})
      \end{modelblock}
      \begin{modelblock}{THDM-II}
        2L thresholds for $\lambda_i$ to the MSSM
      \end{modelblock}
      \begin{modelblock}{THDM-II + $\tilde{h}$ + $\tilde{g}$}
        1L thresholds for $\lambda_i$ to the MSSM
      \end{modelblock}
    \end{column}
  \end{columns}
\end{frame}

\section{Hands-on example: High-scale MSSM (HSSUSY)}

\subsection{Build the spectrum generator}

\begin{frame}{Contents}
  \tableofcontents[currentsubsection,sectionstyle=show/shaded]  
\end{frame}

\begin{frame}{Hands-on example: High-scale MSSM (HSSUSY)}
  \begin{center}
  \begin{tikzpicture}
    \path[arrow] (0,0) -- (0,5) node[left]{$Q$};
    \draw[thick,darkgreen] (0,4) node[left]{$M_S$} -- node[above = 0.5cm,black]{MSSM} (3,4) node[right,black]{fix $\lambda$ from MSSM};
    \draw[thick,dashed,darkgreen] (0,1.5) node[left]{$M_t$} -- (3,1.5) node[right,black]{fix $\mu^2$ by EWSB};
    \draw[thick,darkgreen] (0,1) node[left]{$M_Z$} -- node[above = 1.2cm,black]{SM} node[below = 0.5cm,black]{SM(5)} (3,1) node[right,black]{fix $g_i, y_f, v$ from obs.};
  \end{tikzpicture}
  \end{center}
  FlexibleSUSY's HSSUSY model provides the most precise Higgs mass
  calculation available in the MSSM for $\MS \gg M_t$.
\end{frame}

\newsavebox{\listbox}
\newsavebox{\listboxt}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=Mathematica]
LagNoHC = mu2 conj[H].H -
          1/2 \[Lambda] conj[H].H.conj[H].H;
LagHC   = -(Yd conj[H].d.q + Ye conj[H].e.l
            + Yu u.q.H);
\end{lstlisting}\end{lrbox}

\begin{frame}{Step 0: Chose a \SARAH\ model}
  We chose \SARAH's \texttt{SM} model with the parameters:
  \begin{center}
  \lstinline{g1}, \lstinline{g2}, \lstinline{g3}, \lstinline{Yu},
  \lstinline{Yd}, \lstinline{Ye}, \lstinline{\\[Lambda]},
  \lstinline{mu2}, \lstinline{v}
  \end{center}
  and the non-interaction Lagrangian \\[2em]
  \usebox{\listbox}
  \\[1em]
  See Florian's talk from Monday, 23th October 2017 9am
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=bash]
$ cd FlexibleSUSY/
$ mkdir model_files/HSSUSY/
$ touch model_files/HSSUSY/FlexibleSUSY.m.in
\end{lstlisting}\end{lrbox} % $

\begin{lrbox}{\listboxt}\begin{lstlisting}[language=Mathematica]
FSModelName = "HSSUSY";
FSEigenstates = SARAH`EWSB;
FSDefaultSARAHModel = SM;
\end{lstlisting}\end{lrbox}

\begin{frame}{Step 1: Create FlexibleSUSY model file}
  \usebox{\listbox}
\end{frame}

\begin{frame}{Step 2: Define model information}
  Put into the model file
  \lstinline{model_files/HSSUSY/FlexibleSUSY.m.in}:
  \\[2em]
  \usebox{\listboxt}
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=Mathematica]
EXTPAR = {
    {0, MS},
    {1, M1Input},
    {2, M2Input},
    {3, M3Input},
    {4, MuInput},
    {5, mAInput},
    {6, MEWSB},
    {7, AtInput},
    {25, TanBeta}
};

FSAuxiliaryParameterInfo = {
    {msq2, { LesHouches -> MSQ2IN,
             ParameterDimensions -> {3,3},
             InputParameter -> True } },
    ...
};
\end{lstlisting}\end{lrbox}

\begin{frame}{Step 3: Define MSSM input parameters}
  \usebox{\listbox}
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=Mathematica]
LowScale = LowEnergyConstant[MZ];

LowScaleInput = {
   {v, 2 MZMSbar / Sqrt[3/5 g1^2 + g2^2]},
   {Yu, Automatic},
   {Yd, Automatic},
   {Ye, Automatic}
   (* gauge couplings are fixed automatically *)
};
\end{lstlisting}\end{lrbox}

\begin{frame}{Step 4: Define low-scale boundary condition}
  Fix SM parameters $v^{\MSbar}$, $y_f^{\MSbar}$ and $g_i^{\MSbar}$ at the scale $Q = M_Z$:\\[2em]
  \usebox{\listbox}
  \\[1em]
  \lstinline{MZMSbar} = $m_Z^{\MSbar}(Q)$
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=Mathematica]
EWSBOutputParameters = { mu2 };

SUSYScale = MEWSB;

SUSYScaleInput = {
   FSSolveEWSBFor[EWSBOutputParameters]
};
\end{lstlisting}\end{lrbox}

\begin{frame}{Step 5: Define EWSB-scale boundary condition}
  Fix $\mu^2$ by EWSB condition at the scale $Q$ = \lstinline{MEWSB}:\\[2em]
  \usebox{\listbox}
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=Mathematica]
HighScale = MS;

HighScaleInput = {
   {\[Lambda], lambdaTree + lambda1L}
};

lambdaTree = (3/5 g1^2 + g2^2)/4 Cos[2 ArcTan[TanBeta]]^2;

lambda1L = With[{yt = Yu[3,3],
                 Xt = AtInput - MuInput/TanBeta},
   3/8 yt^4/Pi^2 ( Xt^2/MS^2 - Xt^4/(12 MS^4) )
];
\end{lstlisting}\end{lrbox}

\begin{frame}{Step 6: Define high-scale boundary condition}
  Fix $\lambda$ by matching to the MSSM at scale
  $Q$ = \texttt{MS} at tree-level + leading 1-loop
  \bigcite{0705.1496}:
  \begin{align*}
    \lambda(Q) &= \frac{1}{4} \left[ \frac{3}{5} g_1^2 + g_2^2 \right] \cos^2 2\beta
    + \frac{3}{8} \frac{y_t^4}{\pi^2}\left[
       \frac{X_t^2}{\MS^2}
       - \frac{X_t^4}{12 \MS^4}
    \right]
  \end{align*}
  with $X_t = A_t - \mu/\tan\beta$.
  \\[1em]
  \usebox{\listbox}
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=Mathematica]
UseSM3LoopRGEs    = True; (* 3L RGEs *)
UseYukawa3LoopQCD = True; (* 3L corr. to yt *)
UseSMAlphaS3Loop  = True; (* 3L corr. to alpha_s *)
UseHiggs2LoopSM   = True; (* 2L contributions to Mh *)
UseHiggs3LoopSM   = True; (* 3L contributions to Mh *)
\end{lstlisting}\end{lrbox}

\begin{frame}{Step 7: Enable SM-specific higher order corrections}
  Higher-order corrections from the literature \mycite{hep-ph/9911434,
    hep-ph/9912391, hep-ph/0004189, 1407.4336}:
  \begin{align*}
    m_t &= M_t + \Delta^{(1)} m_t + \Delta^{(2)} m_t + \textcolor{red}{\Delta^{(3)} m_t} \\
    \alpha_s &= \frac{\alpha_s^{\SM(5)}}{1 + \Delta^{(1)} \as + \textcolor{red}{\Delta^{(2)} \as + \Delta^{(3)} \as}} \\
    M_h^2 &= m_h^2 + \Delta^{(1)} m_h^2 + \textcolor{red}{\Delta^{(2)} m_h^2 + \Delta^{(3)} m_h^2}
  \end{align*}
  \\[1em]
  \usebox{\listbox}
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=bash]
$ ./createmodel --name=HSSUSY
$ ./configure --with-models=HSSUSY
$ make -j4
\end{lstlisting}\end{lrbox} % $

\begin{frame}{Step 8: Build the spectrum generator}
  \usebox{\listbox}
  \\[1em]
  \begin{itemize}
  \item[\texttt{1}:] creates the directory \lstinline{models/HSSUSY/}
    with makefile module
  \item[\texttt{2}:] checks the system and creates the \lstinline{Makefile}
  \item[\texttt{3}:] generates the C++ code and compiles it
  \end{itemize}
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=bash]
$ cd models/HSSUSY/
$ ./run_HSSUSY.x --slha-input-file=LesHouches.in.HSSUSY
Block SPINFO
     1   FlexibleSUSY
     2   2.0.1
     5   HSSUSY
     9   4.12.0
Block EXTPAR
    0   2000                 # MS
    4   2000                 # Mu(MS)
    6   173.34               # MEWSB
    7   2000                 # At(MS)
   25   10                   # TanBeta(MS)
Block MASS
        24     8.03785042E+01   # VWp
        25     1.18510822E+02   # hh
...
\end{lstlisting}\end{lrbox} % $

\begin{frame}{Finally: Run HSSUSY}
  Run HSSUSY using the provided SLHA input file
  \lstinline{models/HSSUSY/LesHouches.in.HSSUSY}:\\[2em]
  \usebox{\listbox}
\end{frame}

\subsection{Parameter scan}

\begin{frame}{Contents}
  \tableofcontents[currentsubsection,sectionstyle=show/shaded]  
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=Mathematica]
Get["models/HSSUSY/HSSUSY_librarylink.m"];
\end{lstlisting}\end{lrbox} % $

\begin{frame}{Parameter scan}
  We'll use the \Mathematica\ interface of FlexibleSUSY to perform a
  scan over $\MS$.  (Scanning at the C++ level or via \GAMBIT\ is also possible.)\\[1em]
  Open \Mathematica\ and type:\\[2em]
  \usebox{\listbox}
  \\[1em]
  Now we can use these functions (and more):\\
  \begin{itemize}
  \item[] \texttt{FSHSSUSYOpenHandle[<parameters>]}
  \item[] \texttt{FSHSSUSYCloseHandle[<handle>]}
  \item[] \texttt{FSHSSUSYCalculateSpectrum[<handle>]}
  \item[] \ldots
  \end{itemize}
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=Mathematica]
handle = FSHSSUSYOpenHandle[
    fsSettings -> {
        calculateStandardModelMasses -> 1
    },
    fsModelParameters -> {
        MS      -> 5000,
        MEWSB   -> 173.34,
        TanBeta -> 5,
        MuInput -> 5000,
        AtInput -> 1000
    }
];

spec = FSHSSUSYCalculateSpectrum[handle];

FSHSSUSYCloseHandle[handle];
\end{lstlisting}\end{lrbox} % $

\begin{frame}{Parameter scan}
  \usebox{\listbox}
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=Mathematica]
In[]:= Print[spec];

Out[]=
{HSSUSY -> {
   M[hh] -> 116.74076603621857,
   M[VWp] -> 80.16049791392693,
   Pole[M[hh]] -> 117.38153372733366,
   Pole[M[VWp]] -> 80.37359140369604,
   ...
   \[Lambda] -> 0.22248507579380888,
   Yu -> {{7.493388340878909*^-6, 0., 0.},
          {0., 0.003411223511630361, 0.},
          {0., 0., 0.9384438041061343}},
   ...
   SCALE -> 173.34
 }
}
\end{lstlisting}\end{lrbox} % $

\begin{frame}{Parameter scan}
  \usebox{\listbox}
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=Mathematica]
CalcMh[MSUSY_, TB_, Xtt_] :=
    Module[{handle, spec},
        handle = FSHSSUSYOpenHandle[
            fsSettings -> { ... },
            fsSMParameters -> { ... },
            fsModelParameters -> {
                MS -> MSUSY, MEWSB -> 173.34,
                TanBeta -> TB, MuInput -> MSUSY,
                AtInput -> (Xtt + 1/TB) MSUSY,
                msq2 -> MSUSY^2 IdentityMatrix[3],
                msu2 -> MSUSY^2 IdentityMatrix[3],
                msd2 -> MSUSY^2 IdentityMatrix[3],
                msl2 -> MSUSY^2 IdentityMatrix[3],
                mse2 -> MSUSY^2 IdentityMatrix[3]
            }
        ];
        spec = FSHSSUSYCalculateSpectrum[handle];
        FSHSSUSYCloseHandle[handle];
        Pole[M[hh]] /. (HSSUSY /. spec)
       ];
\end{lstlisting}\end{lrbox} % $

\begin{frame}{Parameter scan}
  Wrap everything into a function (\texttt{TB} = $\tan\beta$, \texttt{Xtt} = $X_t/\MS$):\\[1em]
  \usebox{\listbox}
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=Mathematica]
MS = 5000;
TB = 5;

data = ParallelMap[{ N[#], CalcMh[MS, TB, #] }&,
                   Range[-3.5, 3.5, 0.1]
       ];
\end{lstlisting}\end{lrbox} % $

\begin{frame}{Parameter scan over $X_t/\MS$}
  Scan over $X_t/\MS \in [-3.5, 3.5]$ with $\MS = 5\eh{TeV}$, $\tan\beta = 5$:\\[2em]
  \usebox{\listbox}
\end{frame}

\begin{frame}{Parameter scan over $X_t/\MS$}
  \begin{center}
    \includegraphics[width=0.5\textwidth]{plots/HSSUSY/Mh_Xt_TB-5_MS-5000}
  \end{center}
  FlexibleSUSY's HSSUSY model implements all known 1- and 2-loop
  corrections from \bigcite{1407.4081, 1703.08166}.  This is the most
  precise Higgs mass calculation in the MSSM for $\MS \gg M_t$.
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=Mathematica]
EXTPAR = {
   ...
   {DeltaEFT, 100} (* <-- new input parameter *)
};

HighScaleInput = {
   {\[Lambda], lambdaTree + lambda1L + lambda1LEFT}
};

lambdaTree  = ...;
lambda1L    = ...;
lambda1LEFT = DeltaEFT Yu[3,3]^4/(4 Pi)^2 v^2/MS^2;
\end{lstlisting}\end{lrbox} % $

\begin{frame}{Estimate the EFT uncertainty}
  The pure EFT calculation neglects terms of $O(v^2/\MS^2)$.\\
  Estimate these terms by adding
  \begin{align*}
    \lambda(Q) &= \lambda^{(0L)} + \Delta\lambda^{(1L)}
    + \textcolor{red}{\delta_\text{EFT} \frac{y_t^4}{(4\pi)^2} \frac{v^2}{\MS^2}}
  \end{align*}
  with $\delta_\text{EFT} = 0$ or $1$.\\[1em]
  \usebox{\listbox}
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=Mathematica]
CalcMh[MSUSY_, TB_, Xtt_, deltaEFT_] :=
    Module[{handle, spec},
        handle = FSHSSUSYOpenHandle[
            fsSettings -> { ... },
            fsSMParameters -> { ... },
            fsModelParameters -> {
                ...
                DeltaEFT -> deltaEFT (* <-- set DeltaEFT *)
            }
        ];
        spec = FSHSSUSYCalculateSpectrum[handle];
        FSHSSUSYCloseHandle[handle];
        Pole[M[hh]] /. (HSSUSY /. spec)
       ];
\end{lstlisting}\end{lrbox} % $

\begin{frame}{Estimate the EFT uncertainty}
  Extend our wrapper function:\\[2em]
  \usebox{\listbox}
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=Mathematica]
Xtt = 2;
TB  = 5;

data = ParallelMap[{ N[#],
                     CalcMh[#, TB, Xtt, 0],
                     CalcMh[#, TB, Xtt, 1] }&,
                   LogRange[100, 5 10^4, 100]
       ];
\end{lstlisting}\end{lrbox} % $

\begin{frame}{Estimate the EFT uncertainty}
  Scan over $\MS \in [0.1, 5]\eh{TeV}$ with $X_t/\MS = 2$, $\tan\beta = 5$:\\[2em]
  \usebox{\listbox}
\end{frame}

\begin{frame}{Estimate the EFT uncertainty}
  \includegraphics[width=0.49\textwidth]{plots/HSSUSY/Mh_MS_TB-5_Xt-2_EFT}\hfill
  \includegraphics[width=0.49\textwidth]{plots/HSSUSY/Mh_MS_TB-5_Xt-2_EFT_uncertainty}
\end{frame}

\section{Hands-on example: $(g-2)_\mu$ and $M_h$ in the MRSSM}

\begin{frame}{Contents}
  \tableofcontents[currentsection]  
\end{frame}

\begin{frame}{MRSSM}
  MRSSM = a minimal supersymmetric model with unbroken continuous
  $R$-symmetry.
  \\[1em]
  Fields in the MRSSM on top of the MSSM:
\begin{equation*}
 \hat{R}_d:\textstyle (\mathbf{1} ,\mathbf{2},-\frac{1}{2}) ,
 \hat{R}_u:\textstyle (\mathbf{1} ,\mathbf{2}, \frac{1}{2}) ,
 \hat{S}:\textstyle (\mathbf{1} ,\mathbf{1}, 0) ,
 \hat{T}:\textstyle (\mathbf{1} ,\mathbf{3}, 0) ,
 \hat{O}:\textstyle (\mathbf{8} ,\mathbf{1}, 0)
\end{equation*}
%
Superpotential:
%
\begin{align*}
  \begin{split}
    \mathcal{W}_{\text{MRSSM}} &= \mathcal{W}_{\text{MSSM}}(\mu = 0)
    + \mu_d \hat{R}_d \cdot \hat{H}_d + \mu_u \hat{R}_u\cdot\hat{H}_u \\
    &\phantom{={}}+ \lambda_d \hat{S} \hat{R}_d \cdot \hat{H}_d +
    \lambda_u \hat{S} \hat{R}_u\cdot\hat{H}_u +\Lambda_d
    \hat{R}_d\cdot \hat{T} \hat{H}_d +\Lambda_u \hat{R}_u\cdot\hat{T}
    \hat{H}_u .
  \end{split}
\end{align*}
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=Mathematica]
ExtraSLHAOutputBlocks = {
  {
     (* block name *)
     FlexibleSUSYLowEnergy, NoScale,
     {
        (* entry, FlexibleSUSY's symbol for (g-2) *)
        {21, FlexibleSUSYObservable`aMuon}
     }
  }
};
\end{lstlisting}\end{lrbox} % $

\begin{frame}{Enable $(g-2)_\mu$ in the MRSSM model file}
  Add a new output block \texttt{"FlexibleSUSYLowEnergy"} and write
  $(g-2)_\mu$ to entry 21:
  \\[2em]
  \usebox{\listbox}
  \\[1em]
  Available observables in FlexibleSUSY:
  \begin{align*}
    &\texttt{aMuonGM2Calc},\ \ \texttt{aMuonGM2CalcUncertainty},\ \ \texttt{EDM[<particle>]},\\
    &\texttt{CpHiggsPhotonPhoton},\ \ \texttt{CpHiggsGluonGluon},\\
    &\texttt{CpPseudoScalarPhotonPhoton},\ \ \texttt{CpPseudoScalarGluonGluon}
  \end{align*}
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=bash]
$ ./createmodel --name=MRSSM
$ ./configure --with-models=MRSSM
$ make -j4
\end{lstlisting}\end{lrbox} % $

\begin{lrbox}{\listboxt}\begin{lstlisting}[language=bash]
$ cd models/MRSSM/
$ ./run_MRSSM.x \
    --slha-input-file=LesHouches.in.MRSSM
...
Block FlexibleSUSYLowEnergy Q= 1.00000000E+03
    21    -3.86010766E-12   # Delta(g-2)_muon/2 FlexibleSUSY
\end{lstlisting}\end{lrbox} % $

\begin{frame}{Enable $(g-2)_\mu$ in the MRSSM model file}
  Build the MRSSM:\\[1.5em]
  \usebox{\listbox}
  \\[1em]
  Set \texttt{FlexibleSUSY[15] = 1} in the SLHA input file and run on
  the command line:
  \\[1.5em]
  \usebox{\listboxt}
\end{frame}

\begin{frame}{NLL resummation of $M_h$ (FlexibleEFTHiggs)}
  \begin{center}
  \begin{tikzpicture}
    \path[arrow] (0,0) -- (0,5) node[left]{$Q$};
    \draw[thick,darkgreen] (0,4) node[left]{$M_S$} -- node[above = 0.5cm,black]{MRSSM} (3,4) node[right,black]{fix $\lambda$ from $M_h^\SM = M_h^\MRSSM$ at 1L};
    \draw[thick,dashed,darkgreen] (0,1.5) node[left]{$M_t$} -- (3,1.5) node[right,black]{calculate $M_h$ at 2L};
    \draw[thick,darkgreen] (0,1) node[left]{$M_Z$} -- node[above = 1.2cm,black]{SM} node[below = 0.5cm,black]{SM(5)} (3,1) node[right,black]{fix $g_i, y_f, v$ from obs.};
  \end{tikzpicture}
  \end{center}
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=Mathematica]
FlexibleEFTHiggs = True;
\end{lstlisting}\end{lrbox} % $

\begin{lrbox}{\listboxt}\begin{lstlisting}[language=Mathematica]
SUSYScaleInput = {
    {mq2, LHInput[mq2]},
    {mu2, LHInput[mu2]},
    ...
    (* fix ratio of vu/vd = TanBeta *)
    {vu, Sqrt[vu^2 + vd^2] Sin[ArcTan[TanBeta]]},
    {vd, Sqrt[vu^2 + vd^2] Cos[ArcTan[TanBeta]]}
};

(* fix Sqrt[vu^2 + vd^2] in the MRSSM *)
(* VEV is the SM-like VEV in the MRSSM *)
MatchingScaleInput = {
    {vu, VEV Sin[ArcTan[vu/vd]]},
    {vd, VEV Cos[ArcTan[vu/vd]]}
};
\end{lstlisting}\end{lrbox} % $

\begin{frame}{Enable NLL resummation of $M_h$ (FlexibleEFTHiggs)}
  Set in the model file:\\[1em]
  \usebox{\listbox}
  \\[1em]
  Input model parameters at the SUSY scale:
  \\[1.5em]
  \usebox{\listboxt}
\end{frame}

\begin{lrbox}{\listbox}\begin{lstlisting}[language=bash]
$ ./createmodel --name=MRSSMEFTHiggs
$ ./configure --with-models=MRSSMEFTHiggs
$ make -j4
\end{lstlisting}\end{lrbox} % $

\begin{lrbox}{\listboxt}\begin{lstlisting}[language=bash]
$ cd models/MRSSMEFTHiggs/
$ ./run_MRSSMEFTHiggs.x \
    --slha-input-file=LesHouches.in.MRSSMEFTHiggs
...
Block MASS
        25     1.25072439E+02   # hh
   1000021     5.13209677E+03   # Glu
   3000022     5.15724370E+03   # sigmaO
   3000021     1.22138476E+04   # phiO
       ...
Block FlexibleSUSYLowEnergy Q= 1.00000000E+03
    21     2.61171353E-13   # Delta(g-2)_muon/2 FlexibleSUSY
\end{lstlisting}\end{lrbox} % $

\begin{frame}{Enable NLL resummation of $M_h$ (FlexibleEFTHiggs)}
  Build the \texttt{MRSSMEFTHiggs}:\\[1.5em]
  \usebox{\listbox}
  \\[1em]
  Run on the command line:
  \\[1.5em]
  \usebox{\listboxt}
\end{frame}

\begin{frame}{MRSSM}
  \begin{center}
    \includegraphics[width=0.6\textwidth]{plots/MRSSM/MRSSMEFTHiggs_MS_amu_Mh}
  \end{center}
  $9 m_{\tilde{q}}^2 = 9 m_{\tilde{u}}^2 = m_{\tilde{d}}^2 =
  m_{\tilde{l}}^2 = m_{\tilde{e}}^2 = \MS^2$, $\mu_u = \mu_d = \MS$\\
  $\Delta M_h$ via variation of $Q_\pole$, $Q_\text{match}$ and $y_t^{(2L)}(M_Z)$ vs.\ $y_t^{(3L)}(M_Z)$
\end{frame}

\begin{frame}{Summary}
  \tikz[overlay,remember picture] 
  \node[opacity=0.3, at=(current page.south east),anchor=south east,inner sep=0pt, xshift=-0.2cm, yshift=0.2cm] {
    \includegraphics[height=3cm]{images/FS.png}};%
  %
  \emph{FlexibleSUSY} creates precise spectrum generators for SUSY and
  non-SUSY models.\\[1em]
  \emph{Observables:} $M_h$, $M_W$, BSM masses, $(g-2)_\mu$, EDMs,
  $h\rightarrow\gamma\gamma$, $h\rightarrow gg$
  \\[0.5em]
  \emph{High precision:} 2-loop RGEs, 1-loop self energies, 1-loop
  thresholds, NLL resummation for $M_h$ (\texttt{FlexibleEFTHiggs}),
  model-specific 2-loop and 3-loop corrections from the literature
  \\[0.5em]
  \emph{Flexibility:} multiple BVP solvers, user-defined BCs, modular
  C++ code, SLHA input/output, Mathematica input/output, SQLite output
  \\[0.5em]
  \emph{High speed:} multi-threading, smart linear algebra, lazy evaluation
  \\[1em]
  \emph{Planned extensions:} decays, EWPOs, EFT towers
\end{frame}

\begin{frame}[noframenumbering]
  \begin{center}
    \Huge Backup
  \end{center}
\end{frame}

\begin{frame}[noframenumbering]{Example: CNMSSM}
  \begin{center}
  \begin{tikzpicture}
    \path[arrow] (0,0) -- (0,5) node[left]{$Q$};
    \draw[thick,darkgreen] (0,4) node[left]{$M_X$} -- node[above = 0.5cm,black]{GUT} (3,4) node[right,black]{fix $m_{\tilde{f}}^2, A_f, M_i, \sign v_S, \lambda, \textcolor{red}{m_S^2}$};
    \draw[thick,darkgreen,dashed] (0,2) node[left]{$M_S$} -- (3,2) node[right,black]{fix $|v_S|, \kappa, \textcolor{red}{m_0^2}$};
    \draw[thick,darkgreen] (0,1) node[left]{$M_Z$} -- node[above = 1.2cm,black]{NMSSM} node[below = 0.5cm,black]{SM(5)} (3,1) node[right,black]{fix $g_i, y_f, v_i$};
  \end{tikzpicture}
  \end{center}
  \texttt{FSBVPSolvers = \{ SemiAnalyticSolver \};}
\end{frame}

\end{document}
